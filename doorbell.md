# Retrofit Doorbell Project

The goal of this project is to design and build a doorbell detection circuit using an opto coupler to isolate the voltages and a raspberry pi to monitor the signal on its GPIO ports. The circuit is mounted on a breadboard and connected to the doorbell and the raspberry pi via short electrical leads. The opto coupler is used to isolate the voltages between the doorbell and the raspberry pi, ensuring that the raspberry pi is protected from any high voltage signals generated by the doorbell. The raspberry pi is programmed to monitor the signal on its GPIO ports and trigger a response when the doorbell is pressed. This circuit allows the raspberry pi to detect when the doorbell has been pressed and take appropriate action, such as sending a notification or activating a connected device.

## Design

The doorbell detection circuit consists of a few key components:

1. The opto coupler: This is a device that uses a light-emitting diode (LED) and a photosensitive transistor to isolate the voltages between two circuits. In this case, the LED will be connected to the doorbell circuit, and the transistor will be connected to the raspberry pi circuit. When the doorbell is pressed, the LED will emit a pulse of light, which will be detected by the transistor and trigger a signal on the raspberry pi circuit.

1. The raspberry pi: This is a small computer that can be programmed to perform a variety of tasks. In this case, the raspberry pi will be used to monitor the signal on its GPIO (general-purpose input/output) ports and trigger a response when the doorbell is pressed.

1. The breadboard: This is a device that allows you to easily prototype circuits by connecting components with jumper wires. The breadboard will be used to mount the opto coupler and the raspberry pi, as well as any other components that may be necessary, such as resistors or capacitors.

1. The electrical leads: These are short wires that will be used to connect the doorbell, the opto coupler, and the raspberry pi. The doorbell will be connected to the LED side of the opto coupler, and the raspberry pi will be connected to the transistor side.

To build the doorbell detection circuit, connect all of these components together on the breadboard using jumper wires. Once the circuit is assembled, program the raspberry pi to monitor the signal on its GPIO ports and trigger a response when the doorbell is pressed. This can be done using a variety of programming languages, such as Python or C++.

## Circuit

                +------------+
                |            |
                | Doorbell   |
                |            |
                +------------+
                      |
                      |
                      V
                +------------+
                |            |
                | Opto coupler|
                |            |
                +------------+
                      |
                      |
                      V
                +------------+
                |            |
                | Raspberry Pi|
                |            |
                +------------+

This circuit also requires two resistors in series between the doorbell and the opto coupler and also between the opto coupler and the raspberry pi.

## Components

During build out of this circuit it is advantageous to use the opto coupler on a breadboard in order to experiment with the resistor values in the circuit, particularly so that the circuit does not inadvertently burn out the opto coupler chip. 

Individual Opto Couplers can be found as a packaged dual in line packaged chip (DIP Chip).

[DIP Chip - Compatible with Sharp PC817](https://www.amazon.com/gp/product/B08CXRHDHP/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1)

This opto coupler can also be packaged in a small pre-built circuit. 

[Integrated board with Opto Coupler and built-in resistors](https://www.amazon.com/gp/product/B07GMHLL2M/ref=ppx_yo_dt_b_asin_title_o01_s00?ie=UTF8&psc=1)

## Code

```
import RPi.GPIO as GPIO
import time

# Set up the GPIO pins
GPIO.setmode(GPIO.BCM)
GPIO.setup(17, GPIO.IN, pull_up_down=GPIO.PUD_UP)

# Define the callback function
def doorbell_callback(channel):
  print("Doorbell was pressed!")
  # Insert code here to trigger a response (e.g. send a notification, activate a connected device)

# Set up an event detect on the doorbell pin
GPIO.add_event_detect(17, GPIO.FALLING, callback=doorbell_callback, bouncetime=200)

# Run the program in an infinite loop
while True:
  time.sleep(1)
```

The program first imports the necessary libraries (RPi.GPIO and time) and sets up the GPIO pins. It then defines a callback function that will be called whenever the doorbell is pressed. This function simply prints a message to the console, but you can insert code here to trigger any desired response (e.g. send a notification, activate a connected device).

The program then sets up an event detect on the doorbell pin, using the add_event_detect function from the RPi.GPIO library. This function tells the raspberry pi to listen for a falling edge (a transition from high to low) on the specified pin, and to call the doorbell_callback function whenever it detects one. The bouncetime parameter specifies the minimum amount of time that must pass between successive calls to the callback function.

Finally, the program enters an infinite loop and waits for the doorbell to be pressed. When the doorbell is pressed, the event detect function triggers the callback function, which executes the desired response.


## Testing

The existing telephone system uses the Channel Vision TE 200 circuit board ([manual here](https://jmacfiles.s3.amazonaws.com/TE200II.pdf)).
